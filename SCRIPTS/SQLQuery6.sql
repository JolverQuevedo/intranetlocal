SET DATEFORMAT DMY; select left(CODART,5) as CODGRU, DESgru as DESCRI, SUM (SALE) AS CANT, v.COSTO, (V.COSTO*SUM (SALE)) AS CTO_TOT, SUM(A.PVP-dct-IGV) AS TOT_DOC, ((V.COSTO*SUM (SALE)) - SUM(A.PVP-dct-IGV) )* -1 AS DIF FROM VIEW_VENTAS_ARTICULO A INNER JOIN VIEW_COSTOS V ON left(ltrim(rtrim(a.CODART)),5) COLLATE Modern_Spanish_CI_AI = V.CODIGO WHERE SALE > 0 and isnull(A.pvp,0) > 0  GROUP BY left(codart,5), DESgru, V.COSTO ORDER BY 1